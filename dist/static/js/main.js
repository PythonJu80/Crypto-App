const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./HoldingsDistribution.js","./vendor-react.js","./vendor-charts.js","./PerformanceChart.js"])))=>i.map(i=>d[i]);
import{a as e,r as t,j as r,u as s,b as a,R as i,Q as n,d as l}from"./vendor-react.js";import{P as o}from"./vendor-charts.js";import{a as d,l as c}from"./vendor-network.js";import{m as p,_ as m,A as u}from"./vendor-ui.js";var h;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var x=e;h=x.createRoot,x.hydrateRoot;const f={},g=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),i=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));s=Promise.allSettled(t.map((t=>{if(t=function(e,t){return new URL(e,t).href}(t,r),t in f)return;f[t]=!0;const s=t.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let r=e.length-1;r>=0;r--){const a=e[r];if(a.href===t&&(!s||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const n=document.createElement("link");return n.rel=s?"stylesheet":"modulepreload",s||(n.as="script"),n.crossOrigin="",n.href=t,i&&n.setAttribute("nonce",i),document.head.appendChild(n),s?new Promise(((e,r)=>{n.addEventListener("load",e),n.addEventListener("error",(()=>r(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))};var b=function(){return null};const y=e=>({summary:{...e.summary,totalValueFormatted:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.summary.totalValue),profitLossFormatted:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",signDisplay:"always"}).format(e.summary.profitLoss)},holdings:{...e.holdings,chartData:e.holdings.distribution.map((e=>({name:e.symbol,value:e.allocation})))},performance:{...e.performance,chartData:[{name:"Best",symbol:e.performance.bestPerforming.symbol,value:e.performance.bestPerforming.performance},{name:"Worst",symbol:e.performance.worstPerforming.symbol,value:e.performance.worstPerforming.performance}]}}),j=(e,r)=>{const s=t.useRef(null);return t.useEffect((()=>(s.current=c({path:"/api/ws",query:{channel:e}}),s.current.on("update",r),()=>{s.current&&s.current.disconnect()})),[e,r]),s.current};function v({title:e,titleId:r,...s},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?t.createElement("title",{id:r},e):null,t.createElement("path",{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v16.19l6.22-6.22a.75.75 0 1 1 1.06 1.06l-7.5 7.5a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 1 1 1.06-1.06l6.22 6.22V3a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const w=t.forwardRef(v);function N({title:e,titleId:r,...s},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?t.createElement("title",{id:r},e):null,t.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const P=t.forwardRef(N),k=({data:e})=>{const t=e.profitLoss>=0;return r.jsxs("div",{className:"p-6",children:[r.jsx("h2",{className:"text-xl font-['Press_Start_2P'] mb-6 text-pepe-primary",children:"Portfolio Summary"}),r.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg p-4 border-2 border-pepe-primary animate-usb-pulse",children:[r.jsx("p",{className:"text-pepe-light mb-2",children:"Total Value"}),r.jsx("p",{className:"text-2xl font-['Press_Start_2P'] text-pepe-primary",children:e.totalValueFormatted})]}),r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg p-4 border-2 border-pepe-primary animate-usb-pulse",children:[r.jsx("p",{className:"text-pepe-light mb-2",children:"Profit/Loss"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[t?r.jsx(P,{className:"w-5 h-5 text-pepe-primary"}):r.jsx(w,{className:"w-5 h-5 text-pepe-error"}),r.jsx("p",{className:"text-2xl font-['Press_Start_2P'] "+(t?"text-pepe-primary":"text-pepe-error"),children:e.profitLossFormatted})]}),r.jsxs("p",{className:"text-sm text-pepe-light mt-1",children:[e.profitLossPercentage.toFixed(2),"%"]})]})]}),r.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg p-4 border-2 border-pepe-primary animate-usb-pulse",children:[r.jsx("p",{className:"text-pepe-light mb-2",children:"Total Assets"}),r.jsx("p",{className:"text-xl font-['Press_Start_2P'] text-pepe-primary",children:e.totalAssets})]}),e.largestHolding&&r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg p-4 border-2 border-pepe-primary animate-usb-pulse",children:[r.jsx("p",{className:"text-pepe-light mb-2",children:"Largest Holding"}),r.jsx("p",{className:"text-xl font-['Press_Start_2P'] text-pepe-primary",children:e.largestHolding.symbol}),r.jsxs("p",{className:"text-sm text-pepe-light mt-1",children:[e.largestHolding.allocation.toFixed(2),"%"]})]})]})]})};k.propTypes={data:o.shape({totalValueFormatted:o.string.isRequired,profitLoss:o.number.isRequired,profitLossFormatted:o.string.isRequired,profitLossPercentage:o.number.isRequired,totalAssets:o.number.isRequired,largestHolding:o.shape({symbol:o.string.isRequired,allocation:o.number.isRequired})}).isRequired};const S=({selectedCoins:e,onSelectionChange:s})=>{const[a,i]=t.useState([]),[n,l]=t.useState(!0),[o,d]=t.useState(null);t.useEffect((()=>{fetch("/api/market/top-coins").then((e=>e.json())).then((e=>{if(!e.success)throw new Error("Failed to fetch coins");i(e.data)})).catch((e=>d(e.message))).finally((()=>l(!1)))}),[]);return n?r.jsx("div",{className:"flex items-center justify-center h-20",children:r.jsx("div",{className:"w-6 h-6 border-2 border-pepe-primary rounded-full animate-spin"})}):o?r.jsx("div",{className:"text-pepe-error text-sm p-4 text-center",children:o}):r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-['Press_Start_2P'] text-pepe-light",children:"Watchlist Coins"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.map((t=>r.jsx(p.button,{onClick:()=>(t=>{const r=e.includes(t)?e.filter((e=>e!==t)):[...e,t];s(r)})(t.symbol),whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-2 rounded-lg border-2 transition-colors duration-200 "+(e.includes(t.symbol)?"border-pepe-primary bg-pepe-dark/70 text-pepe-primary":"border-pepe-dark/50 bg-pepe-dark/30 text-pepe-light hover:border-pepe-primary/50"),children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs",children:t.symbol}),r.jsxs("span",{className:"text-xs "+(t.priceChange24h>=0?"text-pepe-primary":"text-pepe-error"),children:[t.priceChange24h>=0?"↑":"↓",Math.abs(t.priceChange24h).toFixed(2),"%"]})]})},t.symbol)))})]})},_=({label:e,value:t,onChange:s,min:a=0,max:i=100,step:n=1})=>r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("label",{className:"text-sm font-['Press_Start_2P'] text-pepe-light",children:e}),r.jsxs("span",{className:"text-sm font-['Press_Start_2P'] text-pepe-primary",children:[t,"%"]})]}),r.jsx("input",{type:"range",min:a,max:i,step:n,value:t,onChange:e=>s(Number(e.target.value)),className:"w-full h-2 bg-pepe-dark rounded-lg appearance-none cursor-pointer\n                 [&::-webkit-slider-thumb]:appearance-none\n                 [&::-webkit-slider-thumb]:w-4\n                 [&::-webkit-slider-thumb]:h-4\n                 [&::-webkit-slider-thumb]:rounded-full\n                 [&::-webkit-slider-thumb]:bg-pepe-primary\n                 [&::-webkit-slider-thumb]:hover:bg-pepe-secondary\n                 [&::-webkit-slider-thumb]:transition-colors\n                 [&::-webkit-slider-thumb]:duration-200"})]}),R=({userId:e})=>{const[s,a]=t.useState({isAutomated:!0,profitThreshold:5,shortTermAllocation:70,longTermAllocation:30,watchlist:[]}),[i,n]=t.useState(!1);j("reinvestment",(e=>{"settings"!==e.type||i||a(e.data)})),t.useEffect((()=>{fetch(`/api/reinvestment/settings/${e}`).then((e=>e.json())).then((e=>{e.success&&a(e.data)})).catch((e=>{}))}),[e]);const l=async(t,r)=>{const i={...s,[t]:r};a(i),n(!0);try{if(!(await fetch(`/api/reinvestment/settings/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Failed to update settings");n(!1)}catch(l){}};return r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg border-2 border-pepe-primary p-6\n                    shadow-pepe hover:shadow-pepe-hover transition-shadow duration-300",children:[r.jsxs("h2",{className:"text-xl font-['Press_Start_2P'] text-pepe-primary mb-6 flex items-center",children:[r.jsx("span",{className:"w-3 h-3 rounded-full bg-pepe-primary animate-usb-pulse mr-3"}),"Reinvestment Controls"]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-['Press_Start_2P'] text-pepe-light",children:"Automated Reinvestment"}),r.jsx(m,{checked:s.isAutomated,onChange:e=>l("isAutomated",e),className:(s.isAutomated?"bg-pepe-primary":"bg-pepe-dark")+" relative inline-flex h-6 w-11 items-center rounded-full border-2 border-pepe-primary\n              transition-colors duration-200 ease-in-out focus:outline-none",children:r.jsx("span",{className:(s.isAutomated?"translate-x-6":"translate-x-1")+" inline-block h-4 w-4 transform rounded-full bg-pepe-dark\n                transition duration-200 ease-in-out"})})]}),r.jsx(p.div,{animate:{opacity:s.isAutomated?1:.5},transition:{duration:.2},children:r.jsx(_,{label:"Profit Threshold",value:s.profitThreshold,onChange:e=>l("profitThreshold",e),min:1,max:50,step:.5})}),r.jsxs(p.div,{animate:{opacity:s.isAutomated?1:.5},transition:{duration:.2},className:"space-y-4",children:[r.jsx(_,{label:"Short-term Allocation",value:s.shortTermAllocation,onChange:e=>{const t=100-e;a((r=>({...r,shortTermAllocation:e,longTermAllocation:t}))),n(!0)}}),r.jsx("div",{className:"flex justify-between text-xs text-pepe-light",children:r.jsxs("span",{children:["Long-term: ",s.longTermAllocation,"%"]})})]}),r.jsx(p.div,{animate:{opacity:s.isAutomated?1:.5},transition:{duration:.2},children:r.jsx(S,{selectedCoins:s.watchlist,onSelectionChange:e=>{l("watchlist",e)}})}),r.jsxs("div",{className:"mt-6 flex items-center space-x-2",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${s.isAutomated?"bg-pepe-primary":"bg-pepe-warning"} animate-usb-pulse`}),r.jsxs("span",{className:"text-xs text-pepe-light",children:[s.isAutomated?"Automated":"Manual"," Mode"]})]})]})]})},L=({onClose:e,onSubmit:t})=>r.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:r.jsxs("div",{className:"bg-pepe-dark/90 rounded-lg border-2 border-pepe-primary p-6 w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-['Press_Start_2P'] text-pepe-primary mb-4",children:"Send Feedback"}),r.jsxs("form",{onSubmit:t,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-['Press_Start_2P'] text-pepe-light mb-2",children:"Type"}),r.jsxs("select",{name:"type",required:!0,className:"w-full bg-pepe-dark/50 border-2 border-pepe-primary rounded-lg px-4 py-2\n                     text-pepe-light focus:outline-none focus:ring-2 focus:ring-pepe-primary",children:[r.jsx("option",{value:"bug",children:"Bug Report"}),r.jsx("option",{value:"feature",children:"Feature Request"}),r.jsx("option",{value:"usability",children:"Usability Issue"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-['Press_Start_2P'] text-pepe-light mb-2",children:"Description"}),r.jsx("textarea",{name:"description",required:!0,rows:4,className:"w-full bg-pepe-dark/50 border-2 border-pepe-primary rounded-lg px-4 py-2\n                     text-pepe-light focus:outline-none focus:ring-2 focus:ring-pepe-primary\n                     resize-none",placeholder:"Please describe your feedback..."})]}),r.jsxs("div",{className:"flex justify-end space-x-4",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-full font-['Press_Start_2P'] text-xs\n                     bg-pepe-dark/50 text-pepe-light hover:bg-pepe-dark/70\n                     transition-colors duration-200",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 rounded-full font-['Press_Start_2P'] text-xs\n                     bg-pepe-primary text-pepe-dark hover:brightness-110\n                     transition-all duration-200",children:"Submit"})]})]})]})}),A=()=>{const[e,s]=t.useState(!1),[a,i]=t.useState(!1);return r.jsxs(r.Fragment,{children:[r.jsx(p.button,{onClick:()=>s(!0),whileHover:{scale:1.05},whileTap:{scale:.95},className:"fixed bottom-4 right-4 bg-pepe-primary text-pepe-dark rounded-full p-4\n                   shadow-pepe hover:shadow-pepe-hover transition-shadow duration-300",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})})}),r.jsx(u,{children:e&&r.jsx(L,{onClose:()=>s(!1),onSubmit:async e=>{e.preventDefault(),i(!0);const t=new FormData(e.target),r={type:t.get("type"),description:t.get("description"),timestamp:(new Date).toISOString(),url:window.location.href,userAgent:navigator.userAgent};try{if(!(await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Failed to submit feedback");s(!1)}catch(a){}finally{i(!1)}}})})]})},C=({size:e="default",message:t="Loading..."})=>{const s={small:"w-8 h-8",default:"w-12 h-12",large:"w-16 h-16"}[e];return r.jsx("div",{className:"flex justify-center items-center min-h-[400px] bg-pepe-dark",children:r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:`${s} rounded-full border-4 border-pepe-dark animate-spin`,children:r.jsx("div",{className:`absolute top-0 left-0 ${s} rounded-full border-t-4 border-pepe-primary animate-usb-pulse`})}),r.jsx("p",{className:"mt-4 text-pepe-primary font-['Press_Start_2P'] text-sm animate-usb-pulse",children:t})]})})};C.propTypes={size:o.oneOf(["small","default","large"]),message:o.string};const T=({message:e,onRetry:t})=>r.jsx("div",{className:"rounded-lg bg-pepe-dark/90 p-6 border-2 border-pepe-error animate-usb-pulse",role:"alert",children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-6 w-6 text-pepe-error",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("h3",{className:"text-lg font-['Press_Start_2P'] text-pepe-error",children:"Error"}),r.jsx("p",{className:"mt-2 text-pepe-light",children:e}),t&&r.jsx("button",{onClick:t,className:"mt-4 pepe-button","aria-label":"Try again",children:"Try again"})]})]})});T.propTypes={message:o.string.isRequired,onRetry:o.func},T.defaultProps={onRetry:null};const E=t.lazy((()=>g((()=>import("./HoldingsDistribution.js")),__vite__mapDeps([0,1,2]),import.meta.url))),F=t.lazy((()=>g((()=>import("./PerformanceChart.js")),__vite__mapDeps([3,1,2]),import.meta.url))),q=()=>r.jsx("div",{className:"flex items-center justify-center h-64 bg-pepe-dark/90 rounded-lg border-2 border-pepe-primary",children:r.jsx(C,{size:"medium",message:"Loading chart..."})}),D=({userId:e})=>{const n=s(),{data:l,isLoading:o,error:c,refetch:m}=a({queryKey:["portfolioDashboard",e],queryFn:()=>(async(e,t="24h")=>{var r;try{return(await d.get(`/api/portfolio/dashboard/${e}`,{params:{timeframe:t}})).data.data}catch(c){if(429===(null==(r=c.response)?void 0:r.status))throw new Error("Rate limit exceeded. Please try again later.");throw new Error("Failed to fetch dashboard data")}})(e),select:y,refetchInterval:3e4,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)});return j(`portfolio-${e}`,(t=>{n.invalidateQueries(["portfolioDashboard",e])})),r.jsxs("div",{className:"min-h-screen bg-pepe-dark",role:"main","aria-label":"Portfolio Dashboard",children:[r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsx(p.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-2xl font-['Press_Start_2P'] text-pepe-primary mb-8",children:"Portfolio Dashboard"}),r.jsx("div",{className:"space-y-8",children:r.jsx(u,{mode:"wait",children:o?r.jsx(C,{size:"large",message:"Loading dashboard..."}):c?r.jsx(T,{message:c.message,onRetry:m}):r.jsxs(i.Fragment,{children:[r.jsx(p.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"pepe-card",children:r.jsx(k,{data:l.summary})},"summary"),r.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"grid grid-cols-1 md:grid-cols-2 gap-8","data-testid":"dashboard-grid",children:[r.jsx("div",{className:"pepe-card hover:shadow-pepe-hover transition-shadow duration-300",role:"region","aria-label":"Holdings Distribution",children:r.jsx(t.Suspense,{fallback:r.jsx(q,{}),children:r.jsx(E,{data:l.holdings})})}),r.jsx("div",{className:"pepe-card hover:shadow-pepe-hover transition-shadow duration-300",role:"region","aria-label":"Performance Overview",children:r.jsx(t.Suspense,{fallback:r.jsx(q,{}),children:r.jsx(F,{data:l.performance})})})]},"charts"),r.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"w-full",children:r.jsx(R,{userId:e})},"reinvestment"),r.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-right text-pepe-light text-sm font-['Press_Start_2P']",children:r.jsxs("time",{dateTime:l.lastUpdated,children:["Last updated: ",new Date(l.lastUpdated).toLocaleString()]})},"timestamp")]})})})]}),r.jsx(A,{})]})};D.propTypes={userId:o.string.isRequired};const O=()=>r.jsx("div",{className:"min-h-screen bg-binance-black",children:r.jsx(D,{userId:1})}),I=new n({defaultOptions:{queries:{staleTime:3e4,refetchOnWindowFocus:!1}}});h(document.getElementById("root")).render(r.jsx(i.StrictMode,{children:r.jsxs(l,{client:I,children:[r.jsx(O,{}),r.jsx(b,{})]})}));
//# sourceMappingURL=main.js.map
